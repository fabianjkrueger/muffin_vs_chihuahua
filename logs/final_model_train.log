2025-02-03 18:15:59,050 - INFO - Training final model...
2025-02-03 18:15:59,050 - INFO - Mps available. Training on GPU...

2025-02-03 18:15:59,050 - INFO - Loading datasets...
2025-02-03 18:15:59,066 - INFO - Number of training images: 4730
2025-02-03 18:15:59,066 - INFO - Number of test images: 1183
2025-02-03 18:15:59,066 - INFO - Classes: ['chihuahua', 'muffin']

2025-02-03 18:15:59,066 - INFO - Initializing model...
2025-02-03 18:15:59,210 - INFO - Freezing layers...
2025-02-03 18:15:59,210 - INFO - Modifying final layer...
2025-02-03 18:15:59,210 - INFO - Moving model to device...

2025-02-03 18:15:59,244 - INFO - Setting up training...
2025-02-03 18:15:59,244 - INFO - Number of epochs: 50
2025-02-03 18:15:59,244 - INFO - Batch size: 32
2025-02-03 18:15:59,244 - INFO - Early stopping patience: 7
2025-02-03 18:15:59,244 - INFO - Early stopping min delta: 0.001
2025-02-03 18:15:59,244 - INFO - Criterion: CrossEntropyLoss()
2025-02-03 18:15:59,244 - INFO - Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

2025-02-03 18:15:59,244 - INFO - Training model...
2025-02-03 18:16:13,320 - INFO - Epoch 1/50:
2025-02-03 18:16:13,321 - INFO - Train Loss: 0.1505, Train Acc: 94.65%
2025-02-03 18:16:13,321 - INFO - Val Loss: 0.0489, Val Acc: 98.65%
2025-02-03 18:16:13,321 - INFO - --------------------------------------------------
2025-02-03 18:16:27,992 - INFO - Epoch 2/50:
2025-02-03 18:16:27,992 - INFO - Train Loss: 0.0539, Train Acc: 98.46%
2025-02-03 18:16:27,992 - INFO - Val Loss: 0.0367, Val Acc: 98.82%
2025-02-03 18:16:27,992 - INFO - --------------------------------------------------
2025-02-03 18:16:42,234 - INFO - Epoch 3/50:
2025-02-03 18:16:42,234 - INFO - Train Loss: 0.0422, Train Acc: 98.63%
2025-02-03 18:16:42,234 - INFO - Val Loss: 0.0332, Val Acc: 99.15%
2025-02-03 18:16:42,234 - INFO - --------------------------------------------------
2025-02-03 18:16:56,221 - INFO - Epoch 4/50:
2025-02-03 18:16:56,221 - INFO - Train Loss: 0.0472, Train Acc: 98.31%
2025-02-03 18:16:56,221 - INFO - Val Loss: 0.0302, Val Acc: 99.07%
2025-02-03 18:16:56,221 - INFO - --------------------------------------------------
2025-02-03 18:17:10,187 - INFO - Epoch 5/50:
2025-02-03 18:17:10,187 - INFO - Train Loss: 0.0363, Train Acc: 98.77%
2025-02-03 18:17:10,187 - INFO - Val Loss: 0.0308, Val Acc: 99.07%
2025-02-03 18:17:10,187 - INFO - --------------------------------------------------
2025-02-03 18:17:23,941 - INFO - Epoch 6/50:
2025-02-03 18:17:23,941 - INFO - Train Loss: 0.0336, Train Acc: 98.96%
2025-02-03 18:17:23,941 - INFO - Val Loss: 0.0312, Val Acc: 98.90%
2025-02-03 18:17:23,941 - INFO - --------------------------------------------------
2025-02-03 18:17:37,613 - INFO - Epoch 7/50:
2025-02-03 18:17:37,614 - INFO - Train Loss: 0.0311, Train Acc: 99.05%
2025-02-03 18:17:37,614 - INFO - Val Loss: 0.0258, Val Acc: 99.07%
2025-02-03 18:17:37,614 - INFO - --------------------------------------------------
2025-02-03 18:17:51,569 - INFO - Epoch 8/50:
2025-02-03 18:17:51,570 - INFO - Train Loss: 0.0310, Train Acc: 98.67%
2025-02-03 18:17:51,570 - INFO - Val Loss: 0.0303, Val Acc: 98.99%
2025-02-03 18:17:51,570 - INFO - --------------------------------------------------
2025-02-03 18:18:05,817 - INFO - Epoch 9/50:
2025-02-03 18:18:05,818 - INFO - Train Loss: 0.0298, Train Acc: 98.96%
2025-02-03 18:18:05,818 - INFO - Val Loss: 0.0275, Val Acc: 98.99%
2025-02-03 18:18:05,818 - INFO - --------------------------------------------------
2025-02-03 18:18:19,546 - INFO - Epoch 10/50:
2025-02-03 18:18:19,546 - INFO - Train Loss: 0.0278, Train Acc: 99.11%
2025-02-03 18:18:19,546 - INFO - Val Loss: 0.0324, Val Acc: 98.90%
2025-02-03 18:18:19,546 - INFO - --------------------------------------------------
2025-02-03 18:18:33,531 - INFO - Epoch 11/50:
2025-02-03 18:18:33,531 - INFO - Train Loss: 0.0360, Train Acc: 98.79%
2025-02-03 18:18:33,531 - INFO - Val Loss: 0.0259, Val Acc: 98.90%
2025-02-03 18:18:33,531 - INFO - --------------------------------------------------
2025-02-03 18:18:47,344 - INFO - Epoch 12/50:
2025-02-03 18:18:47,345 - INFO - Train Loss: 0.0267, Train Acc: 99.15%
2025-02-03 18:18:47,345 - INFO - Val Loss: 0.0243, Val Acc: 99.32%
2025-02-03 18:18:47,345 - INFO - --------------------------------------------------
2025-02-03 18:19:01,315 - INFO - Epoch 13/50:
2025-02-03 18:19:01,316 - INFO - Train Loss: 0.0263, Train Acc: 99.05%
2025-02-03 18:19:01,316 - INFO - Val Loss: 0.0414, Val Acc: 98.56%
2025-02-03 18:19:01,316 - INFO - --------------------------------------------------
2025-02-03 18:19:14,812 - INFO - Epoch 14/50:
2025-02-03 18:19:14,812 - INFO - Train Loss: 0.0212, Train Acc: 99.32%
2025-02-03 18:19:14,812 - INFO - Val Loss: 0.0250, Val Acc: 99.32%
2025-02-03 18:19:14,812 - INFO - --------------------------------------------------
2025-02-03 18:19:28,635 - INFO - Epoch 15/50:
2025-02-03 18:19:28,636 - INFO - Train Loss: 0.0187, Train Acc: 99.45%
2025-02-03 18:19:28,636 - INFO - Val Loss: 0.0248, Val Acc: 99.15%
2025-02-03 18:19:28,636 - INFO - --------------------------------------------------
2025-02-03 18:19:42,677 - INFO - Epoch 16/50:
2025-02-03 18:19:42,677 - INFO - Train Loss: 0.0230, Train Acc: 99.03%
2025-02-03 18:19:42,677 - INFO - Val Loss: 0.0295, Val Acc: 98.99%
2025-02-03 18:19:42,677 - INFO - --------------------------------------------------
2025-02-03 18:19:56,496 - INFO - Epoch 17/50:
2025-02-03 18:19:56,497 - INFO - Train Loss: 0.0227, Train Acc: 99.28%
2025-02-03 18:19:56,497 - INFO - Val Loss: 0.0280, Val Acc: 98.90%
2025-02-03 18:19:56,497 - INFO - --------------------------------------------------
2025-02-03 18:20:10,307 - INFO - Epoch 18/50:
2025-02-03 18:20:10,307 - INFO - Train Loss: 0.0211, Train Acc: 99.24%
2025-02-03 18:20:10,307 - INFO - Val Loss: 0.0226, Val Acc: 99.24%
2025-02-03 18:20:10,307 - INFO - --------------------------------------------------
2025-02-03 18:20:23,985 - INFO - Epoch 19/50:
2025-02-03 18:20:23,985 - INFO - Train Loss: 0.0257, Train Acc: 99.05%
2025-02-03 18:20:23,985 - INFO - Val Loss: 0.0247, Val Acc: 99.07%
2025-02-03 18:20:23,985 - INFO - --------------------------------------------------
2025-02-03 18:20:37,645 - INFO - Epoch 20/50:
2025-02-03 18:20:37,645 - INFO - Train Loss: 0.0163, Train Acc: 99.49%
2025-02-03 18:20:37,645 - INFO - Val Loss: 0.0233, Val Acc: 99.15%
2025-02-03 18:20:37,645 - INFO - --------------------------------------------------
2025-02-03 18:20:51,507 - INFO - Epoch 21/50:
2025-02-03 18:20:51,508 - INFO - Train Loss: 0.0289, Train Acc: 98.94%
2025-02-03 18:20:51,508 - INFO - Val Loss: 0.0251, Val Acc: 99.15%
2025-02-03 18:20:51,508 - INFO - --------------------------------------------------
2025-02-03 18:21:05,220 - INFO - Epoch 22/50:
2025-02-03 18:21:05,221 - INFO - Train Loss: 0.0195, Train Acc: 99.18%
2025-02-03 18:21:05,221 - INFO - Val Loss: 0.0240, Val Acc: 98.99%
2025-02-03 18:21:05,221 - INFO - --------------------------------------------------
2025-02-03 18:21:19,259 - INFO - Epoch 23/50:
2025-02-03 18:21:19,259 - INFO - Train Loss: 0.0180, Train Acc: 99.41%
2025-02-03 18:21:19,259 - INFO - Val Loss: 0.0255, Val Acc: 98.99%
2025-02-03 18:21:19,259 - INFO - --------------------------------------------------
2025-02-03 18:21:32,974 - INFO - Epoch 24/50:
2025-02-03 18:21:32,975 - INFO - Train Loss: 0.0201, Train Acc: 99.28%
2025-02-03 18:21:32,975 - INFO - Val Loss: 0.0255, Val Acc: 99.07%
2025-02-03 18:21:32,975 - INFO - --------------------------------------------------
2025-02-03 18:21:46,749 - INFO - Epoch 25/50:
2025-02-03 18:21:46,749 - INFO - Train Loss: 0.0191, Train Acc: 99.43%
2025-02-03 18:21:46,749 - INFO - Val Loss: 0.0262, Val Acc: 99.07%
2025-02-03 18:21:46,749 - INFO - --------------------------------------------------
2025-02-03 18:21:46,749 - INFO - Early stopping triggered at epoch 25
2025-02-03 18:21:46,749 - INFO - Best epoch: 18
2025-02-03 18:21:46,749 - INFO - Considered min delta of 0.001 for checking improvement in validation loss.
2025-02-03 18:21:46,750 - INFO - Validation metrics at epoch 18:
2025-02-03 18:21:46,750 - INFO - Train Loss: 0.0211, Train Acc: 99.24%
2025-02-03 18:21:46,750 - INFO - Val Loss: 0.0226, Val Acc: 99.24%
2025-02-03 18:21:46,750 - INFO - --------------------------------------------------
2025-02-03 18:21:46,750 - INFO - Loading best model from epoch 18...
2025-02-03 18:21:46,750 - INFO - Training complete.

2025-02-03 18:21:46,750 - INFO - Evaluating model on test set...
2025-02-03 18:21:49,287 - INFO - Final Test Set Metrics:
2025-02-03 18:21:49,287 - INFO - --------------------------------------------------
2025-02-03 18:21:49,287 - INFO - Test Loss:     0.0262
2025-02-03 18:21:49,287 - INFO - Test Accuracy: 99.07%
2025-02-03 18:21:49,287 - INFO - Test ROC AUC:  0.9996
2025-02-03 18:21:49,287 - INFO - Test F1 Score: 0.9899

2025-02-03 18:21:49,287 - INFO - Saving model to /Users/fakrueg/projects/courses/datatalks/ml-zoomcamp/muffin_vs_chihuahua/models/final_model.pt...
2025-02-03 18:21:49,369 - INFO - Model saved.
2025-02-03 18:21:49,370 - INFO - Training complete.

