2025-02-03 16:49:17,564 - INFO - Training final model...
2025-02-03 16:49:17,565 - INFO - Mps available. Training on GPU...

2025-02-03 16:49:17,565 - INFO - Loading datasets...
2025-02-03 16:49:17,580 - INFO - Number of training images: 4730
2025-02-03 16:49:17,580 - INFO - Number of test images: 1183
2025-02-03 16:49:17,580 - INFO - Classes: ['chihuahua', 'muffin']

2025-02-03 16:49:17,580 - INFO - Initializing model...
2025-02-03 16:49:17,741 - INFO - Freezing layers...
2025-02-03 16:49:17,741 - INFO - Modifying final layer...
2025-02-03 16:49:17,742 - INFO - Moving model to device...

2025-02-03 16:49:17,774 - INFO - Setting up training...
2025-02-03 16:49:17,775 - INFO - Number of epochs: 50
2025-02-03 16:49:17,775 - INFO - Batch size: 32
2025-02-03 16:49:17,775 - INFO - Early stopping patience: 7
2025-02-03 16:49:17,775 - INFO - Early stopping min delta: 0.001
2025-02-03 16:49:17,775 - INFO - Criterion: CrossEntropyLoss()
2025-02-03 16:49:17,775 - INFO - Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

2025-02-03 16:49:17,775 - INFO - Training model...
2025-02-03 16:49:31,783 - INFO - Epoch 1/50:
2025-02-03 16:49:31,783 - INFO - Train Loss: 0.1299, Train Acc: 95.98%
2025-02-03 16:49:31,783 - INFO - Val Loss: 0.0438, Val Acc: 98.65%
2025-02-03 16:49:31,783 - INFO - --------------------------------------------------
2025-02-03 16:49:45,560 - INFO - Epoch 2/50:
2025-02-03 16:49:45,560 - INFO - Train Loss: 0.0569, Train Acc: 98.25%
2025-02-03 16:49:45,560 - INFO - Val Loss: 0.0333, Val Acc: 98.90%
2025-02-03 16:49:45,560 - INFO - --------------------------------------------------
2025-02-03 16:49:59,286 - INFO - Epoch 3/50:
2025-02-03 16:49:59,287 - INFO - Train Loss: 0.0464, Train Acc: 98.29%
2025-02-03 16:49:59,287 - INFO - Val Loss: 0.0296, Val Acc: 99.07%
2025-02-03 16:49:59,287 - INFO - --------------------------------------------------
2025-02-03 16:50:13,030 - INFO - Epoch 4/50:
2025-02-03 16:50:13,030 - INFO - Train Loss: 0.0358, Train Acc: 98.63%
2025-02-03 16:50:13,030 - INFO - Val Loss: 0.0297, Val Acc: 99.15%
2025-02-03 16:50:13,031 - INFO - --------------------------------------------------
2025-02-03 16:50:26,730 - INFO - Epoch 5/50:
2025-02-03 16:50:26,730 - INFO - Train Loss: 0.0405, Train Acc: 98.52%
2025-02-03 16:50:26,730 - INFO - Val Loss: 0.0633, Val Acc: 97.55%
2025-02-03 16:50:26,730 - INFO - --------------------------------------------------
2025-02-03 16:50:40,378 - INFO - Epoch 6/50:
2025-02-03 16:50:40,378 - INFO - Train Loss: 0.0396, Train Acc: 98.65%
2025-02-03 16:50:40,378 - INFO - Val Loss: 0.0419, Val Acc: 98.39%
2025-02-03 16:50:40,378 - INFO - --------------------------------------------------
2025-02-03 16:50:54,070 - INFO - Epoch 7/50:
2025-02-03 16:50:54,071 - INFO - Train Loss: 0.0231, Train Acc: 99.22%
2025-02-03 16:50:54,071 - INFO - Val Loss: 0.0266, Val Acc: 99.15%
2025-02-03 16:50:54,071 - INFO - --------------------------------------------------
2025-02-03 16:51:07,788 - INFO - Epoch 8/50:
2025-02-03 16:51:07,789 - INFO - Train Loss: 0.0275, Train Acc: 99.03%
2025-02-03 16:51:07,789 - INFO - Val Loss: 0.0248, Val Acc: 99.24%
2025-02-03 16:51:07,789 - INFO - --------------------------------------------------
2025-02-03 16:51:21,603 - INFO - Epoch 9/50:
2025-02-03 16:51:21,603 - INFO - Train Loss: 0.0333, Train Acc: 98.73%
2025-02-03 16:51:21,603 - INFO - Val Loss: 0.0237, Val Acc: 99.24%
2025-02-03 16:51:21,603 - INFO - --------------------------------------------------
2025-02-03 16:51:35,221 - INFO - Epoch 10/50:
2025-02-03 16:51:35,221 - INFO - Train Loss: 0.0326, Train Acc: 98.88%
2025-02-03 16:51:35,221 - INFO - Val Loss: 0.0239, Val Acc: 99.32%
2025-02-03 16:51:35,221 - INFO - --------------------------------------------------
2025-02-03 16:51:48,434 - INFO - Epoch 11/50:
2025-02-03 16:51:48,434 - INFO - Train Loss: 0.0300, Train Acc: 98.94%
2025-02-03 16:51:48,435 - INFO - Val Loss: 0.0229, Val Acc: 99.15%
2025-02-03 16:51:48,435 - INFO - --------------------------------------------------
2025-02-03 16:52:01,683 - INFO - Epoch 12/50:
2025-02-03 16:52:01,684 - INFO - Train Loss: 0.0307, Train Acc: 99.07%
2025-02-03 16:52:01,684 - INFO - Val Loss: 0.0226, Val Acc: 99.15%
2025-02-03 16:52:01,684 - INFO - --------------------------------------------------
2025-02-03 16:52:15,162 - INFO - Epoch 13/50:
2025-02-03 16:52:15,163 - INFO - Train Loss: 0.0285, Train Acc: 98.96%
2025-02-03 16:52:15,163 - INFO - Val Loss: 0.0223, Val Acc: 99.07%
2025-02-03 16:52:15,163 - INFO - --------------------------------------------------
2025-02-03 16:52:28,457 - INFO - Epoch 14/50:
2025-02-03 16:52:28,457 - INFO - Train Loss: 0.0300, Train Acc: 98.84%
2025-02-03 16:52:28,457 - INFO - Val Loss: 0.0221, Val Acc: 99.24%
2025-02-03 16:52:28,457 - INFO - --------------------------------------------------
2025-02-03 16:52:41,686 - INFO - Epoch 15/50:
2025-02-03 16:52:41,686 - INFO - Train Loss: 0.0262, Train Acc: 99.07%
2025-02-03 16:52:41,686 - INFO - Val Loss: 0.0246, Val Acc: 98.99%
2025-02-03 16:52:41,686 - INFO - --------------------------------------------------
2025-02-03 16:52:55,156 - INFO - Epoch 16/50:
2025-02-03 16:52:55,157 - INFO - Train Loss: 0.0167, Train Acc: 99.49%
2025-02-03 16:52:55,157 - INFO - Val Loss: 0.0238, Val Acc: 98.99%
2025-02-03 16:52:55,157 - INFO - --------------------------------------------------
2025-02-03 16:53:09,245 - INFO - Epoch 17/50:
2025-02-03 16:53:09,245 - INFO - Train Loss: 0.0210, Train Acc: 99.15%
2025-02-03 16:53:09,245 - INFO - Val Loss: 0.0260, Val Acc: 99.15%
2025-02-03 16:53:09,245 - INFO - --------------------------------------------------
2025-02-03 16:53:23,509 - INFO - Epoch 18/50:
2025-02-03 16:53:23,510 - INFO - Train Loss: 0.0180, Train Acc: 99.34%
2025-02-03 16:53:23,510 - INFO - Val Loss: 0.0247, Val Acc: 99.15%
2025-02-03 16:53:23,510 - INFO - --------------------------------------------------
2025-02-03 16:53:37,720 - INFO - Epoch 19/50:
2025-02-03 16:53:37,721 - INFO - Train Loss: 0.0212, Train Acc: 99.13%
2025-02-03 16:53:37,721 - INFO - Val Loss: 0.0241, Val Acc: 99.15%
2025-02-03 16:53:37,721 - INFO - --------------------------------------------------
2025-02-03 16:53:37,721 - INFO - Early stopping triggered at epoch 19
2025-02-03 16:53:37,721 - INFO - Best epoch: 12
2025-02-03 16:53:37,721 - INFO - Considered min delta of 0.001 for checking improvement in validation loss.
2025-02-03 16:53:37,721 - INFO - Validation metrics at epoch 12:
2025-02-03 16:53:37,721 - INFO - Train Loss: 0.0307, Train Acc: 99.07%
2025-02-03 16:53:37,721 - INFO - Val Loss: 0.0226, Val Acc: 99.15%
2025-02-03 16:53:37,721 - INFO - --------------------------------------------------
2025-02-03 16:53:37,721 - INFO - Loading best model from epoch 12...
2025-02-03 16:53:37,722 - INFO - Training complete.

2025-02-03 16:53:37,722 - INFO - Evaluating model on test set...
2025-02-03 16:53:40,330 - INFO - Final Test Set Metrics:
2025-02-03 16:53:40,330 - INFO - --------------------------------------------------
2025-02-03 16:53:40,330 - INFO - Test Loss:     0.0241
2025-02-03 16:53:40,330 - INFO - Test Accuracy: 99.15%
2025-02-03 16:53:40,330 - INFO - Test ROC AUC:  0.9997
2025-02-03 16:53:40,330 - INFO - Test F1 Score: 0.9908

2025-02-03 16:53:40,330 - INFO - Saving model to /Users/fakrueg/projects/courses/datatalks/ml-zoomcamp/muffin_vs_chihuahua/models/final_model.pth...
2025-02-03 16:53:40,391 - INFO - Model saved.
2025-02-03 16:53:40,391 - INFO - Training complete.

